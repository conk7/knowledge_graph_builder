Конвейеризация (pipelining) — одна из самых важных идей в архитектуре процессоров XX века. Впервые систематически применённая в CDC 6600 (1964) и затем доведённая до совершенства в классическом пятистадийном RISC-пайплайне (MIPS R2000, 1985), она остаётся основой всех современных высокопроизводительных ядер.

### Классический пятистадийный пайплайн
1. **IF** — Instruction Fetch  
2. **ID** — Instruction Decode + чтение регистров  
3. **EX** — Execute (ALU или вычисление адреса)  
4. **MEM** — Memory Access (только для load/store)  
5. **WB** — Write-Back в регистровый файл

В идеале каждый такт завершает одну инструкцию и запускает следующую — теоретический прирост производительности в 5× при той же частоте.

### Три типа хазардов, разрушающих иллюзию
- **Structural hazards** — два инструкции одновременно хотят один ресурс (например, одну память в ранних дизайнах)
- **Data hazards** (RAW, WAR, WAW) — зависимости по данным
- **Control hazards** — переходы и ветвления

### Современные методы борьбы
- **Forwarding (bypassing)** — передача результата напрямую из EX в EX или MEM в EX следующей инструкции
- **Stall (pipeline bubble)** — вставка NOP’ов при невозможности forwarding’а
- **Branch prediction + speculative execution** — предугадывание ветвления и выполнение «вперёд»
- **Out-of-order execution** — отказ от строгого порядка завершения инструкций (Tomasulo, 1967 → Pentium Pro, 1995 → всё современное)

### Эволюция глубины пайплайна
| Процессор             | Год  | Глубина пайплайна | Комментарий                                 |
|-----------------------|------|-------------------|---------------------------------------------|
| Intel 486             | 1989 | 5                 | классический in-order                       |
| Pentium (P5)          | 1993 | 5 + суперскаляр   | два целочисленных пайплайна                 |
| Pentium 4 (NetBurst)  | 2000 | 20–31             | гипердлинный пайплайн → провал при mispredict |
| AMD K8                | 2003 | 12–14             | возврат к разумной глубине                  |
| Intel Core (P6 → Skylake и далее) | 2006–2025 | 14–19 | стабильная глубина + мощный OoO             |
| Apple M1–M4           | 2020–2025 | 8–12 (широкий) | ставка на ширину, а не глубину              |

К 2025 году стало ясно: дальше 19–20 стадий увеличивать бессмысленно — штраф за неправильное предсказание ветвления растёт квадратичнее выгоды.

См. также: [[Cache Hierarchy]], [[Virtual Memory]]