Разрыв между скоростью процессорных ядер и DRAM («memory wall») достиг 50–100× уже к началу 2000-х. Единственный способ скрыть эту пропасть — многоуровневая иерархия кэш-памяти, построенная на принципах временной и пространственной локальности.

### Классическая трёхуровневая иерархия 2025 года
| Уровень | Размер (на ядро/кластер) | Латентность | Полоса | Типичная инклюзивность |
|---------|--------------------------|-------------|--------|------------------------|
| L1I     | 32–64 КБ                 | 4–5 тактов  | очень высокая | exclusive или victim |
| L1D     | 32–96 КБ                 | 4–12 тактов | очень высокая | обычно write-back |
| L2      | 512 КБ – 2 МБ            | 12–30 тактов| высокая | обычно exclusive |
| L3 (LLC)| 2–8 МБ на ядро (до 300+ МБ в серверных) | 40–80 тактов | средняя | inclusive или victim |

### Политики включения (inclusion policy)
- **Strictly inclusive** (Intel до Skylake-X) — всё, что в L1/L2, дублируется в L3
- **Non-inclusive / non-exclusive** (AMD Zen с 2017) — L3 может содержать линии, которых нет в L1/L2
- **Exclusive** (IBM POWER, некоторые ARM) — уровни взаимоисключающие, экономит площадь

### Протоколы когерентности кэша
- **MESI** — базовый (Modified, Exclusive, Shared, Invalid)
- **MESIF** — AMD (добавлен Forward state)
- **MOESI** — AMD с 2017 (добавлен Owned state)
- **Directory-based** — в серверных процессорах >32 ядер

### Реальные цифры 2025 года
- Apple M4 Max: 128 КБ L1D + 4 МБ L2 на кластер + 64 МБ SLC (System Level Cache)
- AMD Zen 5: 32 КБ L1D + 1 МБ L2 на ядро + до 96 МБ L3 на CCD
- Intel Lunar Lake: 64 КБ L1D + 2.5 МБ L2 на P-core + 36 МБ L3 на весь чип

### Почему кэш так важен
- 90–95 % всех обращений к памяти удовлетворяются в L1/L2
- Cache miss на L3 → 50–80 нс, на DRAM → 150–300 нс, на CXL/SSD → микросекунды
- Попадание в L1 экономит сотни тактов

Кэш давно перестал быть просто «быстрой памятью» — это сложнейшая адаптивная система с предсказателями, жертвенными буферами, prefetch’ерами и даже собственными нейросетевыми предикторами (Intel Sapphire Rapids и новее).

См. также: [[Virtual Memory]]